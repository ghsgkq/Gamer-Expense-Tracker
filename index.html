<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게이머 가계부 (통합)</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header class="header-nav">
            <a href="index.html" class="active">📊 통합 분석</a>
            <a href="google.html">🎮 Google Play</a>
            <a href="apple.html">🍎 Apple Store</a>
            <a href="recap.html">📅 트릭컬 연말결산</a>
        </header>
        <h1>🎮 게이머 가계부 🍎 (통합)</h1>
        <p>
            Google Takeout의 <strong>'Order History.json'</strong> (<a href="guide/guide.html" target="_blank">파일 다운로드 가이드 보기</a>)<br>
            Apple '문제 신고' 페이지의 <strong>HTML</strong> (<a href="guide/apple_guide.html" target="_blank">파일 다운로드 가이드 보기</a>)<br>
            파일을 업로드하여 결제 내역을 통합 분석하세요.
        </p>
        
        <div class="upload-section">
            <div class="upload-box">
                <label for="googleFileInput"><strong>Google Play (.json)</strong></label>
                <input type="file" id="googleFileInput" accept=".json">
                <span id="googleFileStatus" class="file-status"></span>
            </div>
            <div class="upload-box">
                <label for="appleFileInput"><strong>Apple Store (.html)</strong></label>
                <input type="file" id="appleFileInput" accept=".html, .htm">
                <span id="appleFileStatus" class="file-status"></span>
            </div>
        </div>
        <button id="resetButton">초기화</button>
        
        <!-- 키워드 관리 -->
        <div id="keyword-manager" class="hidden">
            <details>
                <summary><h2>🎮 키워드 관리 (펼치기/접기)</h2></summary>
                <div class="keyword-content">
                    <p>'기타'로 분류된 항목들을 원하는 앱으로 재분류할 수 있습니다. 키워드는 쉼표(,)로 구분해주세요.</p>
                    <div class="keyword-form">
                        <input type="text" id="new-app-name" placeholder="앱 이름 (예: 트릭컬 리바이브)">
                        <input type="text" id="new-keywords" placeholder="키워드 (예: 트릭컬, Trickcal)">
                        <button id="add-keyword-btn">키워드 추가</button>
                    </div>
                    <h3>현재 적용된 키워드</h3>
                    <div class="keyword-search-container">
                        <input type="text" id="keyword-search-input" placeholder="키워드 목록 검색...">
                    </div>
                    <ul id="keywords-list"></ul>
                </div>
            </details>
        </div>

        <!-- 화폐 선택 select -->
        <div id="currency-section" class="hidden">
            <h2>💱 화폐 단위 선택</h2>
            <select id="currency-select"></select>
        </div>
        <!-- 전체 요약 섹션 -->
        <div id="overall-summary-section" class="hidden">
            <div id="overall-summary" class="summary-box"></div>
            <div id="top-spender-summary" class="summary-box secondary"></div>
        </div>
        
        <!-- 전체 통계 차트 섹션 -->
        <div id="overall-stats-section" class="hidden">
            <h2>📊 전체 결제 통계</h2>
            <div class="chart-container">
                <canvas id="overall-spending-chart"></canvas>
            </div>
        </div>

        <!-- 게임 선택 섹션 -->
        <div id="game-selector-section" class="hidden">
            <h2>🔍 앱/게임별 상세 분석</h2>
            <select id="game-selector"></select>
        </div>
        
        <div id="summary" class="summary-box hidden"></div>
        
        <!-- 트릭컬 리바이브 전용 요약 -->
        <div id="trickcal-specific-summary" class="hidden">
            <div id="daily-summary" class="summary-box secondary"></div>
            <div id="pass-summary" class="summary-box tertiary"></div>
            <div id="sashik-pass-summary" class="summary-box quaternary"></div>
        </div>

        <div id="monthly-report" class="hidden">
            <h2>📅 월별 결제 금액 요약 (클릭하여 내역 보기)</h2>
            <div id="monthly-accordion"></div>
            <h3 class="chart-title">월별 결제 차트</h3>
            <div id="monthly-chart-container"></div>
        </div>

        <div id="full-history" class="hidden">
            <h2>🧾 전체 결제 내역</h2>
            
            <div id="filter-section">
                <div id="search-container">
                    <input type="text" id="search-input" placeholder="상품명으로 검색...">
                </div>
                <!-- 트릭컬 리바이브 전용 필터 -->
                <div id="trickcal-filter-buttons" class="hidden">
                    <button class="filter-btn active" data-filter="all">전체 보기</button>
                    <button class="filter-btn" data-filter="데일리 왕사탕 공물">데일리 왕사탕</button>
                    <button class="filter-btn" data-filter="데일리 별사탕 공물">데일리 별사탕</button>
                    <button class="filter-btn" data-filter="데일리 엘리프 공물">데일리 엘리프</button>
                    <button class="filter-btn" data-filter="pass_basic">리바이브/트릭컬 패스</button>
                    <button class="filter-btn" data-filter="pass_sashik">사복 패스</button>
                </div>
            </div>
            <table id="details-table"></table>
        </div>
    </div>
    
    <script src="js/appKeywords.js"></script>
    <script src="js/parsers.js"></script>
    <script src="js/main.js"></script>
</body>
</html>

